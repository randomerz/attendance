#:kivy 1.0.9

#
# Main Structure
#

<SideContainer>:
	side_content: lower_cont
	orientation: 'vertical'

	Button:
		size_hint: 1, .15
		text: "Students"
		on_press: app.switch_to_student()
	Button:
		size_hint: 1, .15
		text: "Attendance"
		on_press: app.switch_to_video()
	Button:
		size_hint: 1, .15
		text: "Training"
		on_press: app.switch_to_train()
	BoxLayout:
		id: lower_cont



#
# Main Content
# 

<StudentMain>:
	pos_hint: {'right': 1}
	size_hint: .9, 1


#
# Side Content
#

<StudentSidebar>:
	padding: 10
	spacing: 10
	orientation: 'vertical'
	Button:
		text: "Add Class"
		on_release: app.show_create_class()
	Button:
		text: "Remove Class"


<VideoSidebar>:
	padding: 10
	spacing: 10
	orientation: 'vertical'
	Button:
		text: "Choose Video"
		on_release: app.show_file()
	Button:
		text: "Live Cam\n(Not implemented)"
	Button:
		text: "Detect Faces"
		on_release: app.show_detect()


<TrainSidebar>:
	padding: 10
	spacing: 10
	orientation: 'vertical'
	Button:
		text: "Choose Video"
		on_release: app.show_file()
	Button:
		text: "Live Cam\n(Not implemented)"
	Button:
		text: "Train Network"


#
# Main Widgets
#

<StudentList>:
	pos_hint: {'right': 1}
	size_hint: .9, 1


<StudentElement>:
	Label:
		id: student_label
		text: root.student_label
		text_size: self.size
		halign: 'left'	


<VideoMain>:
	player: video_player

	VideoPlayer:
		id: video_player
		size: root.size
		source: "vids/boys_geo.mp4"


#
# Side Widgets
#

<LoadFileDialog>:
	BoxLayout:
		size: root.size
		pos: root.pos
		orientation: "vertical"
		FileChooserListView:
			id: filechooser

		BoxLayout:
			size_hint_y: None
			height: 30
			Button:
				text: "Cancel"
				on_release: root.cancel()

			Button:
				text: "Load"
				on_release: app.load(filechooser.path, filechooser.selection)


<CreateClassDialog>:
	BoxLayout:
		size: root.size
		pos: root.pos
		orientation: "vertical"

		BoxLayout:
			orientation: "horizontal"

			BoxLayout:
				orientation: "vertical"

				Label:
					height: 40
					size_hint_y: None
					text: "Student List"

				ScrollView:
					Label:
						text: "test"

			BoxLayout:
				orientation: "vertical"
					
				TextInput:
					height: 40
					size_hint_y: None
					id: text_class_name
					text: "Class TEMP"
				
				BoxLayout:
					orientation: "vertical"
					height: 160
					size_hint_y: None

					GridLayout:
						cols: 2
						row_default_height: 50
						row_force_default: True
						
						Label: 
							text: "Name"
						TextInput:
							id: text_student_name
							text: ""
							
						Button:
							text: "Remove Student"
							on_release: root.cancel()
							
						Button:
							text: "Add Student"
							on_release: root.cancel()

					Button:
						height: 60
						size_hint_y: None
						text: "Import Class from Text File"
		
		BoxLayout:
			size_hint_y: None
			height: 30
			Button:
				text: "Cancel"
				on_release: root.cancel()

			Button:
				text: "Load"
				#on_release: app.load(filechooser.path, filechooser.selection)




<LoadDetectDialog>:
	BoxLayout:
		size: root.size
		pos: root.pos
		orientation: "vertical"

		GridLayout:
			cols: 2

			Label:
				text: "Video Path"
			TextInput:
				id: video_path
				text: "vids/boys_geo.mp4"

			Label:
				text: "Database"
			TextInput:
				id: database_path
				text: "records.db"

			Label:
				text: "Room Location"
			TextInput:
				id: location
				text: "TJ202"

			Label:
				text: "Image Directory"
			TextInput:
				id: image_dir
				text: "imdata"

			Label:
				text: "Save Video To"
			TextInput:
				id: save_video_path
				text: "vids/video_output.mp4"

			Label:
				text: "Save Boxes To"
			TextInput:
				id: save_boxes_path
				text: "boxes/video_boxes.pkl"

			Label:
				text: "Track Faces"
			CheckBox:
				id: track_faces
				active: True

			Label:
				text: "Number of Frames to Analyze"
			TextInput:
				id: num_frames
				text: "16"

		BoxLayout:
			size_hint_y: None
			height: 30
			Button:
				text: "Cancel"
				on_release: root.cancel()

			Button:
				text: "Start"
				on_release: app.detect_faces(video_path.text, database_path.text, location.text, image_dir.text, save_video_path.text, save_boxes_path.text, track_faces.active, num_frames.text)