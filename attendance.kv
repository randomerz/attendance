#:kivy 1.0.9

#
# Main Structure
#

<SideContainer>:
    side_content: lower_cont
    orientation: 'vertical'

    Button:
        size_hint: 1, .15
        text: "Students"
        on_press: app.switch_to_student()
    Button:
        size_hint: 1, .15
        text: "Attendance"
        on_press: app.switch_to_video()
    Button:
        size_hint: 1, .15
        text: "Training"
        on_press: app.switch_to_train()
    BoxLayout:
        id: lower_cont



#
# Main Content
# 

<StudentMain>:
    viewclass: 'SelectableLabel'
    SelectableRecycleBoxLayout:
        default_size: None, dp(56)
        default_size_hint: 1, None
        size_hint_y: None
        height: self.minimum_height
        orientation: 'vertical'
        multiselect: True
        touch_multiselect: True


#
# Side Content
#

<StudentSidebar>:
    padding: 10
    spacing: 10
    orientation: 'vertical'
    Button:
        text: "Add Student"
    Button:
        text: "Remove Student"


<VideoSidebar>:
    padding: 10
    spacing: 10
    orientation: 'vertical'
    Button:
        text: "Choose Video"
        on_release: app.show_file()
    Button:
        text: "Live Cam\n(Not implemented)"
    Button:
        text: "Detect Faces"
        on_release: app.show_detect()


<TrainSidebar>:
    padding: 10
    spacing: 10
    orientation: 'vertical'
    Button:
        text: "Choose Video"
        on_release: app.show_file()
    Button:
        text: "Live Cam\n(Not implemented)"
    Button:
        text: "Train Network"


#
# Main Widgets
#

<SelectableLabel>:
    # Draw a background to indicate selection
    canvas.before:
        Color:
            rgba: (.0, 0.9, .1, .3) if self.selected else (.1, .1, .1, 1)
        Rectangle:
            pos: self.pos
            size: self.size


<VideoMain>:
    player: video_player

    VideoPlayer:
        id: video_player
        size: root.size
        source: "vids/boys_geo.mp4"


#
# Side Widgets
#

<LoadFileDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"
        FileChooserListView:
            id: filechooser

        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: "Cancel"
                on_release: root.cancel()

            Button:
                text: "Load"
                on_release: app.load(filechooser.path, filechooser.selection)


<LoadDetectDialog>:
	BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"

	    GridLayout:
	        cols: 2

	        Label:
	            text: "Video Path"
	        TextInput:
	        	id: video_path
	            text: "Video File"

	        Label:
	            text: "Database"
	        TextInput:
	        	id: database_path
	            text: "db path"

	        Label:
	            text: "Room Location"
	        TextInput:
	        	id: location
	            text: "TJ202"

	        Label:
	            text: "Image Directory"
	        TextInput:
	        	id: image_dir
	            text: "imdata"

	        Label:
	            text: "Save Video To"
	        TextInput:
	        	id: save_video_path
	            text: "sv path"

	        Label:
	            text: "Save Boxes To"
	        TextInput:
	        	id: save_boxes_path
	            text: "sb path"

	        Label:
	            text: "Track Faces"
	        CheckBox:
	        	id: track_faces
	            active: True

	        Label:
	            text: "Number of Frames to Analyze"
	        TextInput:
	        	id: num_frames
	            text: "16"

	    BoxLayout:
	        size_hint_y: None
	        height: 30
	        Button:
	            text: "Cancel"
	            on_release: root.cancel()

	        Button:
	            text: "Start"
	            on_release: app.detect_faces(video_path.text, database_path.text, location.text, image_dir.text, save_video_path.text, save_boxes_path.text, track_faces.active, num_frames.text)